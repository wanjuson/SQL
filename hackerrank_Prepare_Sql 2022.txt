hackerrank_Prepare_Sql 2022년 start

-- The PADS 문자 추출
SELECT
    CONCAT(A.NAME, "(", LEFT(A.OCCUPATION,1), ")") AS AA
FROM OCCUPATIONS A
ORDER BY A.NAME
;
SELECT
    CONCAT("There are a total of ", B.OCC_CNT, " ", LOWER(B.OCCUPATION), "s.") AS AA
FROM 
    (
        SELECT OCCUPATION, COUNT(NAME) AS OCC_CNT
        FROM OCCUPATIONS
        GROUP BY OCCUPATION
    ) B
ORDER BY B.OCC_CNT ASC, B.OCCUPATION 
;

-- Average Population
SELECT ROUND(AVG(POPULATION))
FROM CITY
;

-- Revising Aggregations - Averages
SELECT  AVG(population)
FROM CITY
WHERE District  = 'California'
;

-- Higher Than 75 Marks/order
SELECT 
    NAME
FROM STUDENTS 
WHERE MARKS > 75
ORDER BY RIGHT(NAME,3), ID ASC
;

-- SELECT
SELECT A.*
FROM ANIMAL_INS A
ORDER BY ANIMAL_ID ASC
;

-- The Blunder summit
select CEILING( avg(salary*1.0) - avg(cast(replace(salary, '0', '') as float)) ) 
from EMPLOYEES
;

-- Japan Population
SELECT 
    SUM(POPULATION)
FROM CITY 
WHERE COUNTRYCODE = 'JPN'
;

-- Population Density Difference
SELECT MAX(POPULATION) - MIN(POPULATION)
FROM CITY
;

-- New Companies
SELECT
    COM.company_code, COM.founder 
    , COUNT(DISTINCT EE.lead_manager_code)
    , COUNT(DISTINCT EE.senior_manager_code)
    , COUNT(DISTINCT EE.manager_code)
    , COUNT(DISTINCT EE.employee_code)

FROM company COM
    left JOIN employee EE ON COM.company_code = EE.company_code 
WHERE EE.company_code IS NOT NULL
GROUP BY COM.company_code, COM.founder 
ORDER BY COM.company_code
;

-- The Blunder
SELECT CEIL(AVG(Salary)-AVG(REPLACE(Salary,'0',''))) 
FROM EMPLOYEES
;

-- Top Earners
SELECT
    MAX(MONTHS * SALARY)
    , COUNT(*)
FROM Employee 
WHERE 1=1
    AND MONTHS * SALARY = (SELECT MAX(MONTHS * SALARY) FROM Employee)
;

-- Weather Observation Station 2
SELECT
    ROUND(SUM(LAT_N ),2)
    , ROUND(SUM(LONG_W ) , 2)
FROM STATION 
;

-- Weather Observation Station 13
SELECT
    ROUND(SUM(LAT_N),4)
FROM STATION 
WHERE 1=1
    AND LAT_N BETWEEN 38.788 AND 137.2345
;
;
