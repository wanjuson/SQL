-- 즐겨찾기가 가장 많은 식당 정보 출력하기
SELECT
    REST_INFO.FOOD_TYPE
    , REST_INFO.REST_ID
    , REST_INFO.REST_NAME
    , REST_INFO.FAVORITES
FROM REST_INFO 
    LEFT JOIN
        (
            SELECT FOOD_TYPE, MAX(FAVORITES) FAVORITES_MAX
            FROM REST_INFO
            GROUP BY 1
        ) REST_FAVORITES_MAX
        ON REST_INFO.FOOD_TYPE = REST_FAVORITES_MAX.FOOD_TYPE
        AND REST_INFO.FAVORITES = REST_FAVORITES_MAX.FAVORITES_MAX
WHERE 1=1
    AND REST_FAVORITES_MAX.FAVORITES_MAX IS NOT NULL
ORDER BY REST_INFO.FOOD_TYPE DESC
;
