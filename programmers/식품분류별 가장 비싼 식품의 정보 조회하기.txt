-- 식품분류별 가장 비싼 식품의 정보 조회하기
SELECT
    FOOD_PRODUCT.CATEGORY
    , FOOD_PRODUCT.PRICE
    , FOOD_PRODUCT.PRODUCT_NAME
FROM FOOD_PRODUCT
    LEFT JOIN
        (
            SELECT CATEGORY, MAX(PRICE) PRICE_MAX
            FROM FOOD_PRODUCT
            GROUP BY 1
        ) FOOD_PRICE_MAX
        ON FOOD_PRODUCT.CATEGORY = FOOD_PRICE_MAX.CATEGORY
        AND FOOD_PRODUCT.PRICE = FOOD_PRICE_MAX.PRICE_MAX
WHERE 1=1
    AND FOOD_PRODUCT.CATEGORY IN ('과자', '국', '김치', '식용유')
    AND FOOD_PRICE_MAX.PRICE_MAX IS NOT NULL
ORDER BY FOOD_PRODUCT.PRICE DESC
;
