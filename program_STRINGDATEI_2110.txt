program_STRINGDATEI_2110

-- 루시와 엘라 찾기
SELECT ANIMAL_ID, NAME, SEX_UPON_INTAKE
FROM ANIMAL_INS 
WHERE NAME IN ('Lucy', 'Ella', 'Pickle', 'Rogan', 'Sabrina', 'Mitty')
;

-- 이름에 el이 들어가는 동물 찾기
SELECT ANIMAL_ID, NAME
FROM ANIMAL_INS 
WHERE 1=1
    AND ANIMAL_TYPE = 'Dog'
    AND NAME LIKE '%EL%'
ORDER BY NAME
;

-- 중성화 여부 파악하기
SELECT 
    ANIMAL_ID
    , NAME
    # , SEX_UPON_INTAKE
    , CASE WHEN SEX_UPON_INTAKE LIKE '%Neutered%' THEN "O"  
        WHEN SEX_UPON_INTAKE LIKE '%Spayed%' THEN "O"
        ELSE "X" END AS 중성화
FROM ANIMAL_INS 
WHERE 1=1
ORDER BY ANIMAL_ID
;

-- 오랜 기간 보호한 동물(2)
SELECT
    A.ANIMAL_ID, A.NAME
FROM 
    (
    SELECT
        INS.ANIMAL_ID
        , INS.NAME
        # , CURRENT_DATE
        # , CASE WHEN OUTS.DATETIME IS NULL THEN 
        # , OUTS.DATETIME, INS.DATETIME
        , TIMESTAMPDIFF(HOUR, INS.DATETIME, OUTS.DATETIME) AS TIME_OR
    FROM ANIMAL_INS INS
        INNER JOIN ANIMAL_OUTS OUTS ON INS.ANIMAL_ID = OUTS.ANIMAL_ID
    WHERE 1=1
    ORDER BY TIME_OR DESC
    LIMIT 2
    ) A
# ORDER BY TIME_OR DESC
# LIMIT 2
;


-- DATETIME에서 DATE로 형 변환
SELECT
    ANIMAL_ID, NAME, DATE_FORMAT(DATETIME, '%Y-%m-%d')
FROM ANIMAL_INS
ORDER BY ANIMAL_ID
;
